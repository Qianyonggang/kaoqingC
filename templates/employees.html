{% extends 'base.html' %}
{% block title %}员工总览{% endblock %}
{% block content %}
<div class="card p-3">
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h5 class="mb-0">员工总览（跨团队共享）</h5>
    <a class="btn btn-outline-primary btn-sm" href="{{ url_for('teams') }}">去团队中维护员工</a>
  </div>

  <form method="get" class="mb-3">
    <div class="input-group">
      <input name="q" class="form-control" placeholder="搜索姓名" value="{{ query_text }}">
      <button class="btn btn-outline-secondary">搜索</button>
    </div>
  </form>



  <form method="post" class="border rounded p-3 mb-3 bg-light">
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label fw-semibold">选择团队（可多选）</label>
        <select class="form-select" name="team_ids" multiple size="5">
          {% for t in teams %}
          <option value="{{ t.id }}">{{ t.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-6">
        <label class="form-label fw-semibold">选择员工（可多选）</label>
        <select class="form-select" name="employee_ids" multiple size="5">
          {% for e in items %}
          <option value="{{ e.id }}">{{ e.name }}</option>
          {% endfor %}
        </select>
      </div>
    </div>
    <div class="mt-3 d-flex justify-content-between align-items-center">
      <small class="text-muted">可同时选择团队和员工，系统将合并后清空对应员工全部考勤。</small>
      <button class="btn btn-danger" onclick="return confirm('确认清空所选团队/员工的全部考勤信息吗？');">清空考勤信息</button>
    </div>
  </form>

  <table class="table table-sm align-middle">
    <tr><th>姓名</th><th>日薪</th><th>所属团队</th><th>详情</th></tr>
    {% for e in items %}
      <tr>
        <td>{{ e.name }}</td>
        <td>{{ e.daily_salary }}</td>
        <td>{% for t in e.teams %}<span class="badge text-bg-light border">{{ t.name }}</span> {% endfor %}</td>
        <td><a class="btn btn-sm btn-outline-primary" href="{{ url_for('employee_detail', employee_id=e.id) }}">查看详情</a></td>
      </tr>
    {% else %}
      <tr><td colspan="4" class="text-muted">没有匹配员工</td></tr>
    {% endfor %}
  </table>
</div>
{% endblock %}
